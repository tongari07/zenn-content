---
title: "Panda CSSのスタイリング手法"
emoji: "🐼"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: 
  -  "css"
  -  "Panda CSS"
  -  "frontend"
published: false
publication_name: "moneyforward"
---

Chakra UI のコミュニティが開発している Panda CSS には様々なスタイリング手法があります。

今回はそれらをまとめるとともに長所・短所を探っていきます。

React をベースに話しますが Panda CSS 自体はフレームワーク・ライブラリは選ばずどれでも使えるので適宜読み替えてください。

## Atomic Styles

Panda CSS はオブジェクトとして定義されたスタイルを元に Atomic Styles を生成します。
Atomic Styles とは、1 つのスタイルのみを提供するクラスのことで、Tailwind CSS の utility classes に該当します。Atomic Styles にすることで重複したスタイルの定義を排除して再利用性を高めることができるほか、CSS の全体量を減らすことができます。

Tailwind CSS の場合は utility classes が事前に提供されており、我々はそのクラスを HTML 要素に直接渡すことでスタイリングできます。一方で Panda CSS は CSS in JS なので、提供されている関数に JavaScript のオブジェクトとしてスタイルを渡すことで、それを解析してビルド時に静的な Atomic Styles を生成します。

<details>
<summary>公式ドキュメントから抜粋したコード例</summary>

Panda CSS が提供している css 関数にスタイルを定義したオブジェクトを渡すと、それぞれの値に対応した Atomic Styles が生成されていることがわかります。

```tsx
import { css } from '../styled-system/css'
 
const styles = css({
  backgroundColor: 'gainsboro',  // .bg_gainsboro
  borderRadius: '9999px',        // → .rounded_9999px
  fontSize: '13px',              // → .fs_13px
  padding: '10px 15px'           // → .p_10px_15px 
})
 
<div className={styles}>
  <p>Hello World</p>
</div>
```

```css
@layer utilities {
  .bg_gainsboro {
    background-color: gainsboro;
  }
 
  .rounded_9999px {
    border-radius: 9999px;
  }
 
  .fs_13px {
    font-size: 13px;
  }
 
  .p_10px_15px {
    padding: 10px 15px;
  }
}
```

</details>

### css 関数

```js
const result = css({
    display: 'flex',
    flexDirection: 'column',
    fontWeight: 'semibold',
    color: 'yellow.300',
    textAlign: 'center',
    textStyle: '4xl',
  })

//　result = d_flex flex_column fw_semibold text_yellow.300 text-align_center textStyle_4xl
```

#### css関数の概要

最も基本的な API として提供されている関数です。
上の例で示したように、スタイルを定義したオブジェクトを渡すことでそれぞれの値に対応した Atomic Styles が生成されます。css 関数は戻り値としてクラス名の文字列のリストを返却します。そのため直接 className に渡すこともできますし、一度変数に代入できます。

#### css関数の所感

css 関数を利用することで DOM 構造とスタイリングをかなり近い場所に定義できるため、単純なスタイルであれば可読性は高いと言えます。
しかしスタイルが複雑になりオブジェクトが大きくなるとコードが膨大になり可読性は下がっていきます。特に動的なスタイルの変化が必要な場合や、`:hover` や `:focus` などの擬似クラスを利用するとさらにコードが汚くなってしまいます。また、変数に代入できるものの後述する他の API と比べると再利用性が低いと言えます。

これらを考慮して、主に以下のケースで使用するのが良いと考えます。

- スタイルが非常にシンプルなコンポーネント
- Storybook の story やテストのためのコンポーネントなど、簡単に定義したいもの
- どうしても DOM 構造とスタイルを一緒にしたい場合

総じて中・大規模なコンポーネントや動的にスタイルの切り替わることがあるコンポーネントでは利用が難しいと考えています。

### JSX Style Props

```tsx
import { styled } from '../styled-system/jsx'

const Button = ({ children }) => (
  <styled.button bg="blue.500" color="white" py="2" px="4" rounded="md">
    {children}
  </styled.button>
)
```

#### JSX Style Propsの概要

Chakra UI や MUI のようにコンポーネントの props としてスタイルを定義できる記法です。
上記の例の `<styled.button>` のように、特定の HTML 要素に CSS のプロパティが props として定義されたコンポーネントを利用できます。これらは事前のスタイルは定義されていないものなので、通常の `<button>` 要素などと同様に扱うことができます。

#### JSX Style Propsの所感

Chakra UI や MUI などのコンポーネントの props としてスタイルを定義できるライブラリから移行するときや、それらの記法に慣れたメンバーが多い場合などに採用するのが良いと考えます。実際に Chakra UI から Panda CSS に乗り換えた際には、Chakra UI の VStack や HStack といった単純なレイアウト用のコンポーネントが使われたファイルであれば、import 文のパスを書き換えるだけで移行が完了したケースもありました。

しかしこの記法も css 関数同様に、スタイルが複雑になると可読性が低くなるため注意が必要です。

### Patterns

#### Patternsの概要

Patterns は基本的なレイアウトのスタイルを再利用可能な状態で定義したものです。事前に定義されたものもありますが、カスタムのパターンを定義する方法も提供されています。上記の css 関数と JSX Style Props それぞれを拡張してスタイルが定義された状態で提供されています。

下の例の stack 関数は css 関数に `display: flex; flex-direction: column; gap: 10px;` がデフォルトで定義された関数です。

```tsx
import { stack } from '../styled-system/patterns'
 
function App() {
  return (
    <div className={stack({ gap: '6', padding: '4' })}>
      <div>First</div>
      <div>Second</div>
      <div>Third</div>
    </div>
  )
}
```

下の例の Circle コンポーネントは、JSX Style Props の div 要素が正円になるようにデフォルトでスタイルが定義されたコンポーネントです。

```tsx
import { Circle } from '../styled-system/jsx'
 
function App() {
  return <Circle size='12' bg='red.300' />
}
```

### Atomic Recipe

### Atomic Slot Recipe
